<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title id="titulo-pagina">Evento – Facultad de Ciencias Económicas UNMSM</title>
  <link rel="stylesheet" href="./css/styles.css" />
  <link rel="stylesheet" href="./eventos/css/eventos.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
  <!-- Loader -->
  <div id="loader" class="loader-overlay">
    <div class="bars-spinner">
      <div></div><div></div><div></div><div></div>
    </div>
  </div>

  <header class="header">
    <div class="container">
      <a href="./index.html">
        <img src="./img/index/logo_fce.png" alt="Logo UNMSM" class="logo">
      </a>
    </div>
  </header>

  <main class="main-evento">
    <article class="evento-detalle">
      <a href="./index.html" class="btn-volver-eventos">Volver al inicio</a>
      <img id="evento-imagen" src="" alt="Imagen del evento">
      <h1 id="evento-titulo">Cargando...</h1>
      <p id="evento-fecha"></p>
      <div id="evento-descripcion"></div>
      <div id="evento-enlace">
        <a id="enlace-evento" href="#" target="_blank" class="btn btn-primary">
          Ver más información
        </a>
      </div>
    </article>
    <a href="./eventos-lista.html" class="btn-ir-eventos">Ir a todos los eventos</a>
  </main>

  <footer class="footer">
    <div class="footer-copyright">
      <p>&copy; 2025 Facultad de Ciencias Económicas - UNMSM</p>
    </div>
  </footer>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const id = urlParams.get('id');

    if (!id) {
      document.body.innerHTML = '<h2 style="text-align:center; margin-top:4rem;">ID de evento no especificado.</h2>';
    } else {
      fetch(`/api/eventos/${id}`)
        .then(res => res.json())
        .then(evento => {
          document.getElementById('titulo-pagina').textContent = `Evento - ${evento.titulo}`;
          document.getElementById('evento-titulo').textContent = evento.titulo;
          document.getElementById('evento-fecha').textContent = 
            evento.fecha 
              ? new Date(evento.fecha).toLocaleDateString('es-PE', {
                  weekday: 'long',
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric'
                })
              : 'Fecha no disponible';
          
          if (evento.imagen) {
            document.getElementById('evento-imagen').src = '/' + evento.imagen;
            document.getElementById('evento-imagen').style.display = 'block';
          }
          
          document.getElementById('evento-descripcion').innerHTML = 
            evento.descripcion?.replace(/\n/g, '<br>') || 'Sin descripción.';
          
          if (evento.url) {
            document.getElementById('enlace-evento').href = evento.url;
            document.getElementById('evento-enlace').style.display = 'block';
          }

          // Ocultar loader
          const loader = document.getElementById('loader');
          if (loader) {
            loader.style.opacity = '0';
            setTimeout(() => loader.remove(), 500);
          }
        })
        .catch(err => {
          document.body.innerHTML = '<h2 style="text-align:center; margin-top:4rem;">Evento no encontrado.</h2>';
        });
    }
  </script>
</body>
</html>