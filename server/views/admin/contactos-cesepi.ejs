<%- include('../partials/admin-header', { title: 'Contactos CESEPI' }) %>




<main class="col-md-9 col-lg-10 ms-auto px-4 py-3">

    <div class="d-flex align-items-center justify-content-between mb-4">

        <h1 class="h2 mb-0">

            <i class="fas fa-globe-americas me-2 text-primary"></i>Contactos CESEPI

        </h1>

        <div class="d-flex gap-2">

            <a href="/admin/contactos-cesepi/exportar-excel" class="btn btn-primary">

                <i class="fas fa-file-excel me-2"></i>Excel

            </a>

            <a href="/admin/contactos-cesepi/exportar-pdf" class="btn btn-danger">

                <i class="fas fa-file-pdf me-2"></i>PDF

            </a>

        </div>

    </div>




    <!-- Filtro por fecha -->

    <div class="card mb-4">

        <div class="card-body">

            <form method="GET" action="/admin/contactos-cesepi" class="row g-3 align-items-end">

                <div class="col-md-3">

                    <label class="form-label">Fecha desde</label>

                    <input type="date" name="fechaInicio" class="form-control" value="<%= fechaInicio || '' %>">

                </div>

                <div class="col-md-3">

                    <label class="form-label">Fecha hasta</label>

                    <input type="date" name="fechaFin" class="form-control" value="<%= fechaFin || '' %>">

                </div>

                <div class="col-md-2">

                    <button type="submit" class="btn btn-primary w-100">

                        <i class="fas fa-search me-1"></i>Filtrar

                    </button>

                </div>

                <div class="col-md-2">

                    <a href="/admin/contactos-cesepi" class="btn btn-outline-secondary w-100">

                        <i class="fas fa-times me-1"></i>Limpiar

                    </a>

                </div>

                <div class="col-md-2 text-end">

                    <span class="badge bg-primary fs-6">

                        <i class="fas fa-envelope me-1"></i><%= mensajes ? mensajes.length : 0 %> mensajes

                    </span>

                </div>

            </form>

        </div>

    </div>




    <% if (mensajes && mensajes.length > 0) { %>

        <div class="row g-3">

            <% mensajes.forEach(m => { %>

                <div class="col-md-6 col-lg-4">

                    <div class="card shadow-sm h-100">

                        <div class="card-body d-flex flex-column">

                            <div class="d-flex justify-content-between align-items-start mb-2">

                                <h5 class="card-title text-primary mb-0"><%= m.nombre %></h5>

                                <span class="badge bg-primary"><%= m.oficina %></span>

                            </div>




                            <h6 class="card-subtitle mb-2 text-muted">

                                <i class="fas fa-envelope me-1"></i><%= m.email %><br>

                                <% if (m.telefono) { %>

                                    <i class="fas fa-phone me-1"></i><%= m.telefono %>

                                <% } else { %>

                                    <i class="fas fa-phone text-muted me-1"></i>Sin tel√©fono

                                <% } %>

                            </h6>




                            <p class="card-text flex-grow-1"><%= m.mensaje %></p>




                            <small class="text-muted mt-auto">

                                <i class="far fa-clock me-1"></i>

                                <%= new Date(m.createdAt).toLocaleString('es-PE') %>

                            </small>

                        </div>

                    </div>

                </div>

            <% }); %>

        </div>

    <% } else { %>

        <div class="alert alert-info d-flex align-items-center">

            <i class="fas fa-info-circle me-2"></i>

            <span>No hay mensajes de contacto de CESEPi en el rango de fechas seleccionado.</span>

        </div>

    <% } %>

</main>




<%- include('../partials/admin-footer') %>
